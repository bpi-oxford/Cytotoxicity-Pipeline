

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Native Python Runtime Installation &mdash; pyCyto 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer Guide for Cytotoxicity Pipeline" href="dev_guide.html" />
    <link rel="prev" title="pyCyto Analysis Pipeline" href="pipeline.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyCyto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Python Cytotoxicity Pipeline (pyCyto)</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">pyCyto Analysis Pipeline</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Native Python Runtime Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cuda-acceleration">CUDA Acceleration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dask-cuda">Dask CUDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensorflow">Tensorflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pytorch">pyTorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cuda-and-cudnn-versions">CUDA and CUDNN Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openmpi">OpenMPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mac-os">Mac OS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#required-packages">Required Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fiji">Fiji</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyimagej">PyImageJ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide.html">Developer Guide for Cytotoxicity Pipeline</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyCyto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Native Python Runtime Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/setup.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="native-python-runtime-installation">
<h1>Native Python Runtime Installation<a class="headerlink" href="#native-python-runtime-installation" title="Link to this heading"></a></h1>
<p>Python virtual environment is high recommended. For quick setup, we recommend to use <a class="reference external" href="https://github.com/conda-forge/miniforge#miniforge3">mambaforge</a> as a replacement of anaconda. Replace the <code class="docutils literal notranslate"><span class="pre">mamba</span></code> command if you choose to stay with <code class="docutils literal notranslate"><span class="pre">conda</span></code>.</p>
<p>Create virtual environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>cyto<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.10<span class="w"> </span>-y
mamba<span class="w"> </span>activate<span class="w"> </span>cyto
</pre></div>
</div>
<section id="cuda-acceleration">
<h2>CUDA Acceleration<a class="headerlink" href="#cuda-acceleration" title="Link to this heading"></a></h2>
<p>In some process we can accelerate the analysis process with CUDA GPU. To achieve CUDA version compatibility <strong>Tensorflow 2.12.0</strong> and <strong>pyTorch 2.0.1</strong> must be used together with <strong>CUDA 11.8</strong>.</p>
<section id="dask-cuda">
<h3>Dask CUDA<a class="headerlink" href="#dask-cuda" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://github.com/rapidsai/dask-cuda">Dask CUDA</a> provides various utilities to improve deployment and management of Dask workers on CUDA-enabled systems.</p>
<p>We have to install through mamba/conda instead of pip for better version control.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>rapidsai<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>-c<span class="w"> </span>nvidia<span class="w"> </span>dask-cuda<span class="w"> </span><span class="nv">cudatoolkit</span><span class="o">=</span><span class="m">11</span>.8
</pre></div>
</div>
</section>
<section id="tensorflow">
<h3>Tensorflow<a class="headerlink" href="#tensorflow" title="Link to this heading"></a></h3>
<p>For Stardist segmentation we recommend to use TF2 version. Follow the instruction for <a class="reference external" href="https://www.tensorflow.org/install/pip">TF 2.12 installation</a>.</p>
</section>
<section id="pytorch">
<h3>pyTorch<a class="headerlink" href="#pytorch" title="Link to this heading"></a></h3>
<p>For Cellpose segmentation we recommend to use pyTorch 2.0.. Follow the instruction for <a class="reference external" href="https://pytorch.org/get-started/locally/">pyTorch installation</a>.</p>
</section>
<section id="cuda-and-cudnn-versions">
<h3>CUDA and CUDNN Versions<a class="headerlink" href="#cuda-and-cudnn-versions" title="Link to this heading"></a></h3>
<p>❗The conda environment file automatically choose the compatible version between Tensorflow and pyTorch under same CUDA (11.8) and CUDNN (8.6) settings. If you find CUDA or CUDNN version inconsistency by faulty loading the machine base CUDA libraries, use the following Conda virtual environment setting to override the system-wide paths:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>activate<span class="w"> </span>cyto
mamba<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="nv">cudatoolkit</span><span class="o">=</span><span class="m">11</span>.8.0
python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>nvidia-cudnn-cu11<span class="o">==</span><span class="m">8</span>.6.0.163
mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$CONDA_PREFIX</span>/etc/conda/activate.d
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;CUDNN_PATH=$(dirname $(python -c &quot;import nvidia.cudnn;print(nvidia.cudnn.__file__)&quot;))&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$CONDA_PREFIX</span>/etc/conda/activate.d/env_vars.sh
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export LD_LIBRARY_PATH=$CONDA_PREFIX/lib/:$CUDNN_PATH/lib:$LD_LIBRARY_PATH&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$CONDA_PREFIX</span>/etc/conda/activate.d/env_vars.sh
<span class="nb">source</span><span class="w"> </span><span class="nv">$CONDA_PREFIX</span>/etc/conda/activate.d/env_vars.sh
<span class="c1"># Verify install:</span>
python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import tensorflow as tf; print(tf.config.list_physical_devices(&#39;GPU&#39;))&quot;</span>
<span class="c1"># Verify CUDA and CUDNN</span>
python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import tensorflow as tf; input_shape = (4, 28, 28, 3); x = tf.random.normal(input_shape); y = tf.keras.layers.Conv2D(2, 3, activation=&#39;relu&#39;, input_shape=input_shape[1:])(x); print(y.shape)&quot;</span>
</pre></div>
</div>
</section>
<section id="openmpi">
<h3>OpenMPI<a class="headerlink" href="#openmpi" title="Link to this heading"></a></h3>
<section id="mac-os">
<h4>Mac OS<a class="headerlink" href="#mac-os" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brew<span class="w"> </span>install<span class="w"> </span>openmpi
</pre></div>
</div>
</section>
</section>
</section>
<section id="required-packages">
<h2>Required Packages<a class="headerlink" href="#required-packages" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:bpi-oxford/Cytotoxicity-Pipeline.git
<span class="nb">cd</span><span class="w"> </span>Cytotoxicity-Pipeline
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
<p>If error <code class="docutils literal notranslate"><span class="pre">x86_64-conda_cos6-linux-gnu-c++</span> <span class="pre">command</span> <span class="pre">not</span> <span class="pre">found</span></code> appears during mpi4py installation you will need specific GCC compiler within conda environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>install<span class="w"> </span>gxx_linux-64
</pre></div>
</div>
</section>
<section id="fiji">
<h2>Fiji<a class="headerlink" href="#fiji" title="Link to this heading"></a></h2>
<p>Download Fiji and install TrackMateCSVImporter from CLI:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://downloads.micron.ox.ac.uk/fiji_update/mirrors/fiji-latest/fiji-linux64.zip
unzip<span class="w"> </span>fiji-linux64.zip
rm<span class="w"> </span>fiji-linux64.zip
<span class="nb">cd</span><span class="w"> </span>/Fiji.app
./ImageJ-linux64<span class="w"> </span>--headless<span class="w"> </span>--ij2<span class="w"> </span>--update<span class="w"> </span>add-update-site<span class="w"> </span>TrackMateCSVImporter<span class="w"> </span>https://sites.imagej.net/TrackMateCSVImporter/
</pre></div>
</div>
<p>To configure the path of Fiji specify the path to <code class="docutils literal notranslate"><span class="pre">Fiji.app</span></code> in the line <code class="docutils literal notranslate"><span class="pre">fiji_dir</span></code> in <a class="reference internal" href="#../examples/pipeline.yaml"><span class="xref myst">../examples/pipeline.yaml</span></a></p>
<section id="pyimagej">
<h3>PyImageJ<a class="headerlink" href="#pyimagej" title="Link to this heading"></a></h3>
<p>For the integration of TrackMate, we need to embed PyImageJ for the python wrapping to Fiji.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mamba<span class="w"> </span>install<span class="w"> </span>pyimagej<span class="w"> </span><span class="nv">openjdk</span><span class="o">=</span><span class="m">8</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pipeline.html" class="btn btn-neutral float-left" title="pyCyto Analysis Pipeline" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dev_guide.html" class="btn btn-neutral float-right" title="Developer Guide for Cytotoxicity Pipeline" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jacky Ka Long Ko, Veronika Pfannenstill, Samuel Alber.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>